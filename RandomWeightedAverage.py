#implement Random Weighted Average

#######################################################################

from keras.layers.merge import _Merge
import keras.backend as K

#######################################################################

class RandomWeightedAverage(_Merge):
    """Provides a (random) weighted average between real and generated image samples"""
    def _merge_function(self, inputs):
        alpha = K.random_uniform((32, 1, 1, 1))
        return (alpha * inputs[0]) + ((1 - alpha) * inputs[1])